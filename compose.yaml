services:

  redyellowgreen.api:
    image: redyellowgreen.api
    build:
      context: ./RedYellowGreen
      dockerfile: ./src/RedYellowGreen.Api/Dockerfile
    environment:
      ConnectionStrings__DefaultConnection: "Host=database;Database=RedYellowGreenDb;Username=root;Password=root;Port=5432"
      ASPNETCORE_URLS: http://+:5000
      ASPNETCORE_ENVIRONMENT: Development
      RUN_MIGRATIONS: true
    ports:
      - "5000:5000"

  database:
    image: postgres:18
    container_name: postgres
    restart: always
    environment:
      POSTGRES_USER: root
      POSTGRES_PASSWORD: root
      POSTGRES_DB: RedYellowGreenDb
    ports:
      - "5432:5432"

  redyellowgreen.ui:
    build:
      context: ./UI
      dockerfile: UI.Dockerfile
    ports:
      - "3000:80"
    environment:
      - VITE_API_BASE_URL=http://localhost:5000
    depends_on:
      - redyellowgreen.api